# ITBAN2-Advanced-MySQL-Queries-with-JSON-Data
Set up 'e_commerce' MySQL DB, designed tables for products, orders, order details, and customers. Populated with sample data and documented queries for retrieving product info, orders, filtering, aggregates, JSON operations, and table joins. Included SQL dumps, queries, and screenshots on GitHub.

## *By H. Torlao Jr. & D. Dano Jr.*

### 1. Retrieve Product Information:
* Write a query to fetch the names and descriptions of all products.

```sql
SELECT name, description
FROM products;
```
![image-3](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/88e3dc14-7e1e-473c-8b0c-5cc86eafa086)

* Extend the previous query to include specific attributes such as color, size, and 
price.
```sql
SELECT name, description,
       JSON_EXTRACT(attributes, '$.color') AS color,
       JSON_EXTRACT(attributes, '$.size') AS size,
       JSON_EXTRACT(attributes, '$.price') AS price,
JSON_EXTRACT(attributes, '$.brandName') AS brand
FROM products;
```
![image-4](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/783e4f13-2ac3-417b-9bef-1236a7afac31)


### 2. Query Orders and Order Details:
* Retrieve the details of all orders placed, including the order date, customer ID, 
product name, quantity, and price.
```sql
SELECT
    o.order_id,
    o.order_date,
    o.customer_id,
    p.name AS product_name,
    od.quantity,
    od.price
FROM
    orders o JOIN
    order_details od ON o.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id;
```
![image-5](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/71ec76fc-e1b0-4912-9451-ab2cec28a30b)

* Calculate the total cost of each order.
```sql
SELECT
    o.order_id,
    SUM(od.quantity * od.price) AS total_cost
FROM
    orders o
JOIN
    order_details od ON o.order_id = od.order_id
GROUP BY
    o.order_id;
```
![image-6](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/32259044-a47f-4499-8586-2848aa3644cd)


### 3. Filtering Products Based on Attributes:
* Write a query to find all products with a price greater than $50.
```sql
SELECT *
FROM products
WHERE JSON_EXTRACT(attributes, '$.price') > 50;
```
![image-7](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/0870d973-5376-4225-8dd3-c9a5f2acef40)

* Filter products by color and brand, and display their names and prices.

```sql
SELECT name, JSON_EXTRACT(attributes, '$.price') AS price
FROM products
WHERE JSON_EXTRACT(attributes, '$.color') = 'teal' 
AND JSON_EXTRACT(attributes, '$.brandName') = 'Stiedemann LLC';
```
![image-8](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/6b40bb05-9d95-4d94-b871-1b53c80f2a80)

### 4. Calculating Aggregate Data:
* Calculate the total sales revenue generated by each product.
```sql
SELECT 
    p.product_id,
    p.name AS product_name,
    SUM(od.quantity * od.price) AS total_revenue
FROM 
    products p
JOIN 
    order_details od ON p.product_id = od.product_id
GROUP BY 
    p.product_id, p.name;
```
![image-9](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/7ede900a-2fe5-4b6e-94bb-3ed76182ccd8)

* Determine the total quantity of each product ordered.
```sql
SELECT 
    p.product_id,
    p.name AS product_name,
    SUM(od.quantity) AS total_quantity
FROM 
    products p
JOIN 
    order_details od ON p.product_id = od.product_id
GROUP BY 
    p.product_id, p.name;
```
![image-10](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/fc353d3a-f86f-4b47-8204-3d31e54860f7)

### 5. Advanced Filtering and Aggregation:
* Find the top 5 best-selling products based on total quantity sold.
```sql
SELECT
    p.product_id,
    p.name AS product_name,
    SUM(od.quantity) AS total_quantity_sold
FROM
    products p
JOIN
    order_details od ON p.product_id = od.product_id
GROUP BY
    p.product_id, p.name
ORDER BY
    total_quantity_sold DESC Limit 5;
```
![image-11](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/c01397e7-637f-43e5-a00e-1fa7e53a4750)

* Identify the average price of products from a specific brand.
```sql
SELECT
    AVG(JSON_EXTRACT(attributes, '$.price')) AS average_price,
    JSON_EXTRACT(attributes, '$.brandName') AS brand
FROM
    products
WHERE
    JSON_EXTRACT(attributes, '$.brandName') = 'Bayer - Harvey'
GROUP BY
    JSON_EXTRACT(attributes, '$.brandName');
```
![image-12](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/f4e87d2f-9b78-44b3-86f7-53d13f6d23d1)

### 6. Nested JSON Queries:
* Retrieve the color and size of a specific product.
```sql
SELECT
    JSON_EXTRACT(attributes, '$.color') AS color,
    JSON_EXTRACT(attributes, '$.size') AS size
FROM
    products
WHERE
    product_id = 1234;
```
![image-13](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/aa5cbed3-2680-42a3-8982-59ffadf85ac5)

* Extract and display all available attributes of products in JSON format.
```sql
SELECT JSON_OBJECT(
    'product_id', product_id,
    'name', name,
    'description', description,
    'attributes', attributes
) AS product_info
FROM products;
```
![image-14](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/6853ffe1-552e-4785-8e03-a97dae17d8d4)

### 7. Joining Multiple Tables:
* Write a query to find all orders placed by customers along with the products 
ordered and their quantities.
```sql
SELECT 
    o.order_id,
    o.order_date,
    c.customer_id,
    p.name AS product_name,
    od.quantity
FROM 
    orders o
JOIN 
    order_details od ON o.order_id = od.order_id
JOIN 
    products p ON od.product_id = p.product_id
JOIN 
    customers c ON o.customer_id = c.customer_id;
```
![image-15](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/b82ccfbd-bb55-4203-bb66-56021faca8ae)

* Calculate the total revenue generated by each customer.
```sql
SELECT
    CONCAT(c.firstname, ' ', COALESCE(c.middlename, ''), ' ', c.lastname) AS full_name,
    c.customer_id,
    SUM(od.quantity * JSON_EXTRACT(p.attributes, '$.price')) AS total_revenue
FROM
    customers c
JOIN
    orders o ON c.customer_id = o.customer_id
JOIN
    order_details od ON o.order_id = od.order_id
JOIN
    products p ON od.product_id = p.product_id
GROUP BY
    c.customer_id, full_name;
```
![image-16](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/9cffaa24-5aa5-419f-b720-b0904b26cd45)

### 8. Data Manipulation with JSON Functions: 
* Update the price of a specific product stored as JSON attribute.
  
**_The original price of the product id 1234._**
```sql
SELECT product_id,
       JSON_EXTRACT(attributes, '$.price') AS price
FROM products
WHERE product_id=1234;
```
![image-17](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/9e2140f2-d31a-4c60-92d2-5d5e02623fcf)

**_The query to update the specific price of the product id 1234._**
```sql
UPDATE products
SET attributes = JSON_SET(attributes, '$.price', 800.00)
WHERE product_id = 1234;
```
![image-18](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/01e05e0c-2ad3-424a-9363-3fe3812c32c0)

**_Updated Price of the product id number 1234._**
```sql
SELECT product_id,
       JSON_EXTRACT(attributes, '$.price') AS price
FROM products
WHERE product_id=1234;
```
![image-19](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/6a61c0c8-8bde-45ff-89bd-a8d72d8c63f2)

* Add a new attribute to all products with a default value.
```sql
ALTER TABLE products ADD COLUMN weight VARCHAR(255) DEFAULT 'default_value';
```
![image-20](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/faeeed69-800a-44c2-b6c1-e962a8550f55)

**_This is the product attributes with newly added weight attribute._**
```sql
SELECT name, description,
       JSON_EXTRACT(attributes, '$.color') AS color,
       JSON_EXTRACT(attributes, '$.size') AS size,
       JSON_EXTRACT(attributes, '$.price') AS price,
 JSON_EXTRACT(attributes, '$.brandName') AS brand,
       JSON_EXTRACT(attributes, '$.weight') AS weight
FROM products;
```
![image-21](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/c429e3f8-6f9e-42f1-bebc-29ac13cffa0e)

### 9. Advanced JSON Operations: 
* Find products with specific attributes that match a given criteria using JSON path 
expressions.
```sql
SELECT *
FROM products
WHERE JSON_EXTRACT(attributes, '$.color') = 'blue'
  AND JSON_EXTRACT(attributes, '$.size') = 'medium';
```
![image-22](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/a1312302-6de9-4182-83dc-0bfcc2ec47ba)

* Extract and display the first element of an array stored within a JSON attribute.
```sql
SELECT JSON_UNQUOTE(JSON_EXTRACT(attributes,'$.color')) 
AS first_element FROM `products`;
```
![image-23](https://github.com/GrinHornet/ITBAN2-Advanced-MySQL-Queries-with-JSON-Data/assets/125188016/511590f4-5b17-4baa-8bfd-fc238ceb7ddf)

## END

Thank you for visiting our repository! We hope you find the information provided here useful. If you have any questions or feedback, feel free to reach out to us. Don't forget to check out our other projects and contributions. Happy coding!
